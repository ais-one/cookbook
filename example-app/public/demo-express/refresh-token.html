<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Vanilla Javascript Samples</title>
</head>
<body>
  <h1>AA Authentication, OTP & Refresh Token <a href="index.html">Back</a></h1>
  <ul>
    <li>Clear application data (localStorage & httponly cookie)</li>
    <li>check console for logs</li>
    <li>check configs token expiry, refresh expiry, httponly?, use otp = TEST?</li>
  </ul>
  <button onclick="login()">Login test / test</button><br/>
  <button onclick="otp()">Send OTP 111111</button><br/>
  <button onclick="testAuth()">Get Private Data</button><br/>
  <button onclick="logout()">Logout</button><br/>
  <button id="test-ed">test</button><br/>
</body>
<script type="module">
  import { test, http, login, otp, testAuth, logout } from '/js/http.js'

  document.querySelector("#test-ed").onclick = test
  
  let token = ''
  let refreshToken = ''
  
  function parseJwt (token) {
      var base64Url = token.split('.')[1];
      var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
      var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      }).join(''));  
      return JSON.parse(jsonPayload);
  }
  
  // need to improve on this
  window.login = login
  window.otp = otp
  window.testAuth = testAuth
  window.logout = logout

  </script>

</html>
